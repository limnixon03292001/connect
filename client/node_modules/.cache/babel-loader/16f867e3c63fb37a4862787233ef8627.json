{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Lim\\\\Desktop\\\\Clone\\\\login-mern\\\\client\\\\src\\\\components\\\\layout\\\\Search.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport axios from \"axios\";\nimport { Link, useHistory } from 'react-router-dom';\nimport { useDispatch, useSelector } from 'react-redux';\nimport defaultImage from '../../svg/defaultImage.jpg';\nimport Loupe from \"../../svg/loupe.svg\";\nimport loadingCat from \"../../svg/loadingCat.svg\";\nimport { useSmallModalCloser } from '../.././customHooks/hooks';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Search = () => {\n  _s();\n\n  const user = useSelector(state => state.users);\n  const [data, setData] = useState(\"\");\n  const history = useHistory();\n  const dispatch = useDispatch();\n  const {\n    smallRef,\n    smallModal,\n    setSmallModal\n  } = useSmallModalCloser(false);\n  useEffect(() => {\n    dispatch({\n      type: 'CLEAR_SEARCH_USER'\n    });\n  }, [data, dispatch]);\n  useEffect(() => {\n    // this cancelToken is for cancelling an API request everytime the component unmount\n    if (data.trim() === \"\") {\n      return;\n    }\n\n    const CancelToken = axios.CancelToken;\n    let cancel;\n    setSmallModal(true);\n    dispatch({\n      type: 'SEARCH_LOADING'\n    });\n    axios.get(`/users/search?q=${data}`, {\n      cancelToken: new CancelToken(function executor(c) {\n        // An executor function receives a cancel function as a parameter\n        cancel = c;\n      })\n    }).then(({\n      data\n    }) => {\n      dispatch({\n        type: 'SEARCH_USER',\n        payload: data\n      });\n    }).catch(error => {\n      if (axios.isCancel(error)) {\n        console.log('Request Canceled sa search');\n      } else {\n        var _error$response;\n\n        dispatch({\n          type: 'ERRORS',\n          payload: error\n        });\n\n        if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401) {\n          dispatch({\n            type: 'LOGOUT'\n          });\n          history.push('/login');\n        }\n      }\n    });\n    return () => cancel();\n  }, [data, dispatch, history, setSmallModal]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"relative\",\n    children: [/*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"relative\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"Search user...\",\n        className: \"md:h-14 p-3 w-full bg-primary rounded pl-11 outline-none focus:border-blue-500\",\n        value: data,\n        onChange: e => setData(e.target.value),\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(Link, {\n        to: `/search?user=${data}`,\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"absolute left-0 top-0 bottom-0 flex items-center p-3\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: Loupe,\n            alt: \"search\",\n            className: \"w-6 h-5\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 66,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 13\n    }, this), smallModal && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-primary max-h-64 overflow-y-auto overflow-x-hidden absolute mt-1 shadow-md z-30 w-full rounded-md space-y-1\",\n      ref: smallRef,\n      children: user.searchLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-3 p-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: loadingCat,\n          alt: \"loading...\",\n          className: \"h-10 w-10 object-cover\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Looking for \", data]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 21\n      }, this) : user.searchUser.map(user => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full h-20 z-10 relative overflow-hidden shadow\",\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          to: `/profile/${user._id}`,\n          children: [(user === null || user === void 0 ? void 0 : user.coverPhoto) && /*#__PURE__*/_jsxDEV(\"img\", {\n            src: user.coverPhoto,\n            alt: \"\",\n            className: \"object-cover object-center w-full h-full opacity-40\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 51\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex gap-4 items-center space-y-3  absolute inset-0 overflow-hidden\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-20 h-full rounded-tl-md rounded-bl-md\",\n              children: (user === null || user === void 0 ? void 0 : user.imageUrl) ? /*#__PURE__*/_jsxDEV(\"img\", {\n                src: user === null || user === void 0 ? void 0 : user.imageUrl,\n                alt: \"\",\n                className: \"w-full h-full object-cover object-center\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 85,\n                columnNumber: 55\n              }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n                src: defaultImage,\n                alt: \"\",\n                className: \"w-full h-full object-cover object-center\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 85,\n                columnNumber: 146\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 84,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex flex-col justify-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n                className: \"text-sm font-semibold text-white\",\n                children: [user === null || user === void 0 ? void 0 : user.firstname, \" \", user === null || user === void 0 ? void 0 : user.lastname]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 88,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs text-gray-200\",\n                children: user === null || user === void 0 ? void 0 : user.email\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 89,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 87,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 25\n        }, this)\n      }, user._id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 25\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Search, \"zsOF9EBgsBVhNoR3KTlYroNgjto=\", false, function () {\n  return [useSelector, useHistory, useDispatch, useSmallModalCloser];\n});\n\n_c = Search;\nexport default Search;\n\nvar _c;\n\n$RefreshReg$(_c, \"Search\");","map":{"version":3,"sources":["C:/Users/Lim/Desktop/Clone/login-mern/client/src/components/layout/Search.js"],"names":["React","useState","useEffect","axios","Link","useHistory","useDispatch","useSelector","defaultImage","useSmallModalCloser","Search","user","state","users","data","setData","history","dispatch","smallRef","smallModal","setSmallModal","type","trim","CancelToken","cancel","get","cancelToken","executor","c","then","payload","catch","error","isCancel","console","log","response","status","push","e","target","value","Loupe","searchLoading","loadingCat","searchUser","map","_id","coverPhoto","imageUrl","firstname","lastname","email"],"mappings":"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","sourcesContent":["import React,{ useState, useEffect } from 'react';\r\nimport axios from \"axios\";\r\nimport { Link, useHistory } from 'react-router-dom';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\nimport defaultImage from '../../svg/defaultImage.jpg';\r\nimport Loupe from '../../svg/loupe.svg';\r\nimport loadingCat from '../../svg/loadingCat.svg';\r\nimport { useSmallModalCloser } from '../.././customHooks/hooks'\r\n\r\nconst Search = () => {\r\n\r\n    const user = useSelector(state => state.users);\r\n    const [data, setData]= useState(\"\");\r\n    const history = useHistory();\r\n    const dispatch = useDispatch();\r\n\r\n    const {smallRef, smallModal, setSmallModal} = useSmallModalCloser(false);\r\n\r\n    useEffect(() => {\r\n        dispatch({type: 'CLEAR_SEARCH_USER'});\r\n    },[data,dispatch]);\r\n\r\n    useEffect(() => {\r\n         // this cancelToken is for cancelling an API request everytime the component unmount\r\n         if(data.trim() === \"\"){\r\n             return\r\n         }\r\n         const CancelToken = axios.CancelToken;\r\n         let cancel;\r\n        setSmallModal(true)\r\n        dispatch({type: 'SEARCH_LOADING'});\r\n        axios.get(`/users/search?q=${data}`, { cancelToken: new CancelToken(function executor(c) {\r\n            // An executor function receives a cancel function as a parameter\r\n            cancel = c;\r\n          }) }).then(({data})=>{\r\n            dispatch({type: 'SEARCH_USER', payload: data});\r\n        }).catch((error) => {\r\n            if (axios.isCancel(error)) {\r\n                console.log('Request Canceled sa search'); \r\n            }\r\n            else{\r\n                dispatch({type:'ERRORS', payload: error});\r\n                if(error.response?.status === 401){\r\n                    dispatch({type: 'LOGOUT'});\r\n                    history.push('/login');\r\n                }\r\n            }\r\n        });\r\n\r\n        return () => cancel();\r\n    },[data,dispatch,history,setSmallModal])\r\n\r\n\r\n    return (\r\n        <div className=\"relative\"> \r\n            <form className=\"relative\">\r\n              \r\n                    <input type=\"text\" placeholder=\"Search user...\" className=\"md:h-14 p-3 w-full bg-primary rounded pl-11 outline-none focus:border-blue-500\"  \r\n                        value={data}\r\n                        onChange={(e) => setData(e.target.value)}\r\n                        required\r\n                    />\r\n                    <Link to={`/search?user=${data}`}>\r\n                        <button className=\"absolute left-0 top-0 bottom-0 flex items-center p-3\">\r\n                            <img src={Loupe} alt=\"search\" className=\"w-6 h-5\" />\r\n                        </button>\r\n                    </Link>\r\n            </form>\r\n            {smallModal &&\r\n            <div className=\"bg-primary max-h-64 overflow-y-auto overflow-x-hidden absolute mt-1 shadow-md z-30 w-full rounded-md space-y-1\" ref={smallRef}>\r\n                {/* <div> */}\r\n                {user.searchLoading ?\r\n                    <div className=\"flex items-center space-x-3 p-3\">\r\n                        <img src={loadingCat} alt=\"loading...\" className=\"h-10 w-10 object-cover\"/>\r\n                        <p>Looking for {data}</p>\r\n                    </div> : \r\n                    user.searchUser.map((user) => (\r\n                        <div key={user._id} className=\"w-full h-20 z-10 relative overflow-hidden shadow\">\r\n                        <Link to={`/profile/${user._id}`}>\r\n                            {user?.coverPhoto &&  <img src={user.coverPhoto} alt=\"\" className=\"object-cover object-center w-full h-full opacity-40\"/>}\r\n                        \r\n                            <div className=\"flex gap-4 items-center space-y-3  absolute inset-0 overflow-hidden\">\r\n                                <div className=\"w-20 h-full rounded-tl-md rounded-bl-md\">\r\n                                    {user?.imageUrl ? <img src={user?.imageUrl} alt=\"\" className=\"w-full h-full object-cover object-center\" /> : <img src={defaultImage} alt=\"\" className=\"w-full h-full object-cover object-center\" />}\r\n                                </div>\r\n                                <div className=\"flex flex-col justify-center\">\r\n                                    <h1 className=\"text-sm font-semibold text-white\">{user?.firstname} {user?.lastname}</h1>\r\n                                    <p className=\"text-xs text-gray-200\">{user?.email}</p>\r\n                                </div>\r\n                            </div>\r\n                        </Link>\r\n                    </div>\r\n                    ))\r\n                    }\r\n                {/* </div> */}\r\n            </div>\r\n             }\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Search\r\n"]},"metadata":{},"sourceType":"module"}