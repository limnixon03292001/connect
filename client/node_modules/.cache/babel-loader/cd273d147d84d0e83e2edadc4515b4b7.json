{"ast":null,"code":"import _slicedToArray from\"C:/Users/Lim/Desktop/Clone/login-mern/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import axios from\"axios\";import{Link,useHistory}from'react-router-dom';import{useDispatch,useSelector}from'react-redux';import Loupe from\"../../svg/loupe.svg\";import loadingCat from\"../../svg/loadingCat.svg\";import{useSmallModalCloser}from'../.././customHooks/hooks';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Search=function Search(){var user=useSelector(function(state){return state.users;});var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var history=useHistory();var dispatch=useDispatch();var _useSmallModalCloser=useSmallModalCloser(false),smallRef=_useSmallModalCloser.smallRef,smallModal=_useSmallModalCloser.smallModal,setSmallModal=_useSmallModalCloser.setSmallModal;useEffect(function(){dispatch({type:'CLEAR_SEARCH_USER'});},[data,dispatch]);useEffect(function(){// this cancelToken is for cancelling an API request everytime the component unmount\nif(data===\"\"){return;}var CancelToken=axios.CancelToken;var cancel;setSmallModal(true);dispatch({type:'SEARCH_LOADING'});axios.get(\"/users/search?q=\".concat(data),{cancelToken:new CancelToken(function executor(c){// An executor function receives a cancel function as a parameter\ncancel=c;})}).then(function(_ref){var data=_ref.data;dispatch({type:'SEARCH_USER',payload:data});}).catch(function(error){if(axios.isCancel(error)){console.log('Request Canceled sa search');}else{var _error$response;dispatch({type:'ERRORS',payload:error});if(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===401){dispatch({type:'LOGOUT'});history.push('/login');}}});return function(){return cancel();};},[data,dispatch,history,setSmallModal]);return/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsxs(\"form\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search user...\",className:\"md:h-14 p-3 w-full bg-primary rounded pl-11 outline-none focus:border-blue-500\",value:data,onChange:function onChange(e){return setData(e.target.value);},required:true}),/*#__PURE__*/_jsx(Link,{to:\"/search?user=\".concat(data),children:/*#__PURE__*/_jsx(\"button\",{className:\"absolute left-0 top-0 bottom-0 flex items-center p-3\",children:/*#__PURE__*/_jsx(\"img\",{src:Loupe,alt:\"search\",className:\"w-6 h-5\"})})})]}),smallModal&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-primary max-h-64 overflow-y-auto overflow-x-hidden absolute mt-1 shadow-md z-30 w-full rounded-md space-y-1\",ref:smallRef,children:user.searchLoading?/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 p-3\",children:[/*#__PURE__*/_jsx(\"img\",{src:loadingCat,alt:\"loading...\",className:\"h-10 w-10 object-cover\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Looking for \",data]})]}):user.searchUser.map(function(user){return/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-20 z-10 relative overflow-hidden shadow\",children:/*#__PURE__*/_jsxs(Link,{to:\"/profile/\".concat(user._id),children:[(user===null||user===void 0?void 0:user.coverPhoto)&&/*#__PURE__*/_jsx(\"img\",{src:user.coverPhoto,alt:\"\",className:\"object-cover object-center w-full h-full opacity-40\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-4 items-center space-y-3  absolute inset-0 overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-20 h-full rounded-tl-md rounded-bl-md\",children:/*#__PURE__*/_jsx(\"img\",{src:user===null||user===void 0?void 0:user.imageUrl,alt:\"\",className:\"w-full h-full object-cover object-center\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col justify-center\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"text-sm font-semibold text-white\",children:[user===null||user===void 0?void 0:user.firstname,\" \",user===null||user===void 0?void 0:user.lastname]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-200\",children:user===null||user===void 0?void 0:user.email})]})]})]})},user._id);})})]});};export default Search;","map":{"version":3,"sources":["C:/Users/Lim/Desktop/Clone/login-mern/client/src/components/layout/Search.js"],"names":["React","useState","useEffect","axios","Link","useHistory","useDispatch","useSelector","useSmallModalCloser","Search","user","state","users","data","setData","history","dispatch","smallRef","smallModal","setSmallModal","type","CancelToken","cancel","get","cancelToken","executor","c","then","payload","catch","error","isCancel","console","log","response","status","push","e","target","value","Loupe","searchLoading","loadingCat","searchUser","map","_id","coverPhoto","imageUrl","firstname","lastname","email"],"mappings":"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","sourcesContent":["import React,{ useState, useEffect } from 'react';\r\nimport axios from \"axios\";\r\nimport { Link, useHistory } from 'react-router-dom';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\nimport Loupe from '../../svg/loupe.svg';\r\nimport loadingCat from '../../svg/loadingCat.svg';\r\nimport { useSmallModalCloser } from '../.././customHooks/hooks'\r\n\r\nconst Search = () => {\r\n\r\n    const user = useSelector(state => state.users);\r\n    const [data, setData]= useState(\"\");\r\n    const history = useHistory();\r\n    const dispatch = useDispatch();\r\n\r\n    const {smallRef, smallModal, setSmallModal} = useSmallModalCloser(false);\r\n\r\n    useEffect(() => {\r\n        dispatch({type: 'CLEAR_SEARCH_USER'});\r\n    },[data,dispatch]);\r\n\r\n    useEffect(() => {\r\n         // this cancelToken is for cancelling an API request everytime the component unmount\r\n         if(data === \"\"){\r\n             return\r\n         }\r\n         const CancelToken = axios.CancelToken;\r\n         let cancel;\r\n        setSmallModal(true)\r\n        dispatch({type: 'SEARCH_LOADING'});\r\n        axios.get(`/users/search?q=${data}`, { cancelToken: new CancelToken(function executor(c) {\r\n            // An executor function receives a cancel function as a parameter\r\n            cancel = c;\r\n          }) }).then(({data})=>{\r\n            dispatch({type: 'SEARCH_USER', payload: data});\r\n        }).catch((error) => {\r\n            if (axios.isCancel(error)) {\r\n                console.log('Request Canceled sa search'); \r\n            }\r\n            else{\r\n                dispatch({type:'ERRORS', payload: error});\r\n                if(error.response?.status === 401){\r\n                    dispatch({type: 'LOGOUT'});\r\n                    history.push('/login');\r\n                }\r\n            }\r\n        });\r\n\r\n        return () => cancel();\r\n    },[data,dispatch,history,setSmallModal])\r\n\r\n\r\n    return (\r\n        <div className=\"relative\"> \r\n            <form className=\"relative\">\r\n              \r\n                    <input type=\"text\" placeholder=\"Search user...\" className=\"md:h-14 p-3 w-full bg-primary rounded pl-11 outline-none focus:border-blue-500\"  \r\n                        value={data}\r\n                        onChange={(e) => setData(e.target.value)}\r\n                        required\r\n                    />\r\n                    <Link to={`/search?user=${data}`}>\r\n                        <button className=\"absolute left-0 top-0 bottom-0 flex items-center p-3\">\r\n                            <img src={Loupe} alt=\"search\" className=\"w-6 h-5\" />\r\n                        </button>\r\n                    </Link>\r\n            </form>\r\n            {smallModal &&\r\n            <div className=\"bg-primary max-h-64 overflow-y-auto overflow-x-hidden absolute mt-1 shadow-md z-30 w-full rounded-md space-y-1\" ref={smallRef}>\r\n                {/* <div> */}\r\n                {user.searchLoading ?\r\n                    <div className=\"flex items-center space-x-3 p-3\">\r\n                        <img src={loadingCat} alt=\"loading...\" className=\"h-10 w-10 object-cover\"/>\r\n                        <p>Looking for {data}</p>\r\n                    </div> : \r\n                    user.searchUser.map((user) => (\r\n                        <div key={user._id} className=\"w-full h-20 z-10 relative overflow-hidden shadow\">\r\n                        <Link to={`/profile/${user._id}`}>\r\n                            {user?.coverPhoto &&  <img src={user.coverPhoto} alt=\"\" className=\"object-cover object-center w-full h-full opacity-40\"/>}\r\n                        \r\n                            <div className=\"flex gap-4 items-center space-y-3  absolute inset-0 overflow-hidden\">\r\n                                <div className=\"w-20 h-full rounded-tl-md rounded-bl-md\">\r\n                                    <img src={user?.imageUrl} alt=\"\" className=\"w-full h-full object-cover object-center\" />\r\n                                </div>\r\n                                <div className=\"flex flex-col justify-center\">\r\n                                    <h1 className=\"text-sm font-semibold text-white\">{user?.firstname} {user?.lastname}</h1>\r\n                                    <p className=\"text-xs text-gray-200\">{user?.email}</p>\r\n                                </div>\r\n                            </div>\r\n                        </Link>\r\n                    </div>\r\n                    ))\r\n                    }\r\n                {/* </div> */}\r\n            </div>\r\n             }\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Search\r\n"]},"metadata":{},"sourceType":"module"}